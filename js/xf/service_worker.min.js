self.addEventListener("push",function(c){if(self.Notification&&"granted"===self.Notification.permission){try{var a=c.data.json()}catch(f){console.warn("Received push notification but payload not in the expected format.");return}if(a&&a.title&&a.body){a.last_count=0;var b={body:a.body,dir:a.dir||"ltr",data:a};a.badge&&(b.badge=a.badge);a.icon&&(b.icon=a.icon);var d;if(a.tag&&a.tag_phrase)b.tag=a.tag,b.renotify=!0,self.registration.getNotifications({tag:a.tag}).then(function(a){if(a=a[a.length-1])d=
a.data.last_count+1,b.data.last_count=d}).then(function(){0<d&&(b.body=b.body+" "+a.tag_phrase.replace("{count}",d.toString()));e=self.registration.showNotification(a.title,b)});else var e=self.registration.showNotification(a.title,b);c.waitUntil(e)}else console.warn("Received push notification but no payload data or required fields missing.")}});self.addEventListener("notificationclick",function(c){var a=c.notification;a.close();a.data.url&&c.waitUntil(clients.openWindow(a.data.url))});
